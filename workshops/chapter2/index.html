
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Learn how to use your evaluation data to create few-shot examples and training datasets for fine-tuning">
      
      
      
        <link rel="canonical" href="https://567-labs.github.io/systematically-improving-rag/workshops/chapter2/">
      
      
        <link rel="prev" href="../chapter1/">
      
      
        <link rel="next" href="../chapter3-1/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Converting Evaluations into Training Data - Systematically Improving RAG Applications</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#converting-evaluations-into-training-data-for-fine-tuning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
  <p>
    This material is supported by <a href="https://maven.com/applied-llms/rag-playbook?promoCode=EBOOK" target="_blank"><strong>Applied LLMs on Maven</strong></a>.  Readers get 20% off.
    Not ready? Check out the <a href="https://fivesixseven.ck.page/rag-crash-course" target="_blank"><strong>free email course</strong></a>.
  </p>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Systematically Improving RAG Applications" class="md-header__button md-logo" aria-label="Systematically Improving RAG Applications" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Systematically Improving RAG Applications
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Converting Evaluations into Training Data
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Workshops

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../office-hours/" class="md-tabs__link">
          
  
  
    
  
  Office Hours

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../talks/" class="md-tabs__link">
          
  
  
    
  
  Talks

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Systematically Improving RAG Applications" class="md-nav__button md-logo" aria-label="Systematically Improving RAG Applications" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Systematically Improving RAG Applications
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Workshops
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Workshops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Chapter 1: Starting the Flywheel
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Chapter 1: Starting the Flywheel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Chapter 2: From Evaluation to Enhancement
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Chapter 2: From Evaluation to Enhancement
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-generic-embeddings-fall-short" class="md-nav__link">
    <span class="md-ellipsis">
      Why Generic Embeddings Fall Short
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Generic Embeddings Fall Short">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-elusive-nature-of-similarity" class="md-nav__link">
    <span class="md-ellipsis">
      The Elusive Nature of "Similarity"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-hidden-assumptions-in-provider-models" class="md-nav__link">
    <span class="md-ellipsis">
      The Hidden Assumptions in Provider Models
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#from-evaluation-to-few-shot-examples" class="md-nav__link">
    <span class="md-ellipsis">
      From Evaluation to Few-Shot Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="From Evaluation to Few-Shot Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-power-of-examples-in-context" class="md-nav__link">
    <span class="md-ellipsis">
      The Power of Examples in Context
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-the-right-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Selecting the Right Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-your-few-shot-library" class="md-nav__link">
    <span class="md-ellipsis">
      Building Your Few-Shot Library
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-effective-triplets-for-rag" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Effective Triplets for RAG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-challenge-of-hard-negatives-and-how-ux-can-help" class="md-nav__link">
    <span class="md-ellipsis">
      The Challenge of Hard Negatives and How UX Can Help
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-power-of-re-rankers-in-rag-systems" class="md-nav__link">
    <span class="md-ellipsis">
      The Power of Re-Rankers in RAG Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Power of Re-Rankers in RAG Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bi-encoders-vs-cross-encoders-understanding-the-trade-offs" class="md-nav__link">
    <span class="md-ellipsis">
      Bi-Encoders vs. Cross-Encoders: Understanding the Trade-offs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-training-data-for-re-rankers" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Training Data for Re-Rankers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-fine-tuning-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Fine-Tuning Workflow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Fine-Tuning Workflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#when-to-fine-tune-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      When to Fine-Tune Embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-fine-tuning-process" class="md-nav__link">
    <span class="md-ellipsis">
      The Fine-Tuning Process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Fine-Tuning Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-data-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Data Preparation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-model-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Model Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-training-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Training Infrastructure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measuring-success" class="md-nav__link">
    <span class="md-ellipsis">
      Measuring Success
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-pitfalls-to-avoid" class="md-nav__link">
    <span class="md-ellipsis">
      Common Pitfalls to Avoid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resources-for-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Resources for Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-different-approaches-systematically" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Different Approaches Systematically
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-a-roadmap-for-continuous-improvement" class="md-nav__link">
    <span class="md-ellipsis">
      Building a Roadmap for Continuous Improvement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-adapters-a-cost-effective-alternative" class="md-nav__link">
    <span class="md-ellipsis">
      Linear Adapters: A Cost-Effective Alternative
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reflection-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Reflection Questions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion-and-next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion and Next Steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Chapter 3: User Experience
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Chapter 3: User Experience
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter3-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design Principles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter3-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feedback Collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter3-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iterative Improvement
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Chapter 4: Topic Modeling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Chapter 4: Topic Modeling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter4-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter4-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prioritization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Chapter 5: Multimodal Capabilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Chapter 5: Multimodal Capabilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter5-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter5-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Chapter 6: Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Chapter 6: Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter6-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Routing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter6-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter6-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Improvement
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../office-hours/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Office Hours
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Office Hours
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/AGENTS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 1: Starting the Flywheel
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Chapter 1: Starting the Flywheel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort2/week1-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 2 - Week 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort3/week-1-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 3 - Session 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort3/week-1-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 3 - Session 2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 2: From Evaluation to Enhancement
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Chapter 2: From Evaluation to Enhancement
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort2/week2-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 2 - Week 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort3/week-2-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 3 - Session 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort3/week-2-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 3 - Session 2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 3: User Experience
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Chapter 3: User Experience
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort2/week3-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 2 - Week 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort3/week-3-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 3 - Session 1
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 4: Topic Modeling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Chapter 4: Topic Modeling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort2/week4-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 2 - Week 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort3/week-4-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 3 - Session 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort3/week-4-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 3 - Session 2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 5: Multimodal Capabilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            Chapter 5: Multimodal Capabilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort2/week5-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 2 - Week 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort3/week-5-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 3 - Session 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort3/week-5-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 3 - Session 2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 6: Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            Chapter 6: Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../office-hours/cohort2/week6-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cohort 2 - Week 6
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../talks/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Talks
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Talks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Search / Indexing / Chunking
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Search / Indexing / Chunking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/chromadb-anton-chunking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Text Chunking Strategies (Anton, ChromaDB)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/john-lexical-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lexical Search in RAG Applications (John Berryman)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/query-routing-anton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query Routing for RAG Systems (Anton, ChromaDB)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/semantic-search-exa-will-bryk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why Google Search Sucks for AI (Will Bryk, Exa)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/rag-without-apis-browser-michael-struwig/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How OpenBB Ditched APIs and Put RAG in the Browser (Michael Struwig)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Finetuning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Finetuning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/glean-manav/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Building Custom Embedding Models Per Customer (Manav, Glean)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/fine-tuning-rerankers-embeddings-ayush-lancedb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The 12% RAG Performance Boost You're Missing (Ayush, LanceDB)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/embedding-performance-generative-evals-kelly-hong/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stop Trusting MTEB Rankings (Kelly Hong, Chroma)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Monitoring
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Monitoring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/online-evals-production-monitoring-ben-sidhant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why Your AI Is Failing in Production (Ben & Sidhant)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/rag-antipatterns-skylar-payne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The RAG Mistakes That Are Killing Your AI (Skylar Payne)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/zapier-vitor-evals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How Zapier 4x'd Their AI Feedback Collection (Vitor)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Coding Agents
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Coding Agents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/rag-is-dead-cline-nik/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why Cline Ditched RAG for Direct Code Reading (Nik Pash)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/colin-rag-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grep Beat Embeddings on SWE-Bench (Colin Flaherty, Augment)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/sourcegraph-agentic-code-agent-rag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agentic RAG from first principles (Beyang Liu, Sourcegraph)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/devin-cognition-multi-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why Devin does not use multi-agents (Walden Yan)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Document Processing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Document Processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/reducto-docs-adit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why Most Document Parsing Sucks (Adit, Reducto)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/superlinked-encoder-stacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encoder Stacking and Multi-Modal Retrieval (Daniel, Superlinked)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/extend-document-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How Extend Achieves 95%+ Document Automation (Eli Badgio)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-generic-embeddings-fall-short" class="md-nav__link">
    <span class="md-ellipsis">
      Why Generic Embeddings Fall Short
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Generic Embeddings Fall Short">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-elusive-nature-of-similarity" class="md-nav__link">
    <span class="md-ellipsis">
      The Elusive Nature of "Similarity"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-hidden-assumptions-in-provider-models" class="md-nav__link">
    <span class="md-ellipsis">
      The Hidden Assumptions in Provider Models
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#from-evaluation-to-few-shot-examples" class="md-nav__link">
    <span class="md-ellipsis">
      From Evaluation to Few-Shot Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="From Evaluation to Few-Shot Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-power-of-examples-in-context" class="md-nav__link">
    <span class="md-ellipsis">
      The Power of Examples in Context
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-the-right-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Selecting the Right Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-your-few-shot-library" class="md-nav__link">
    <span class="md-ellipsis">
      Building Your Few-Shot Library
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-effective-triplets-for-rag" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Effective Triplets for RAG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-challenge-of-hard-negatives-and-how-ux-can-help" class="md-nav__link">
    <span class="md-ellipsis">
      The Challenge of Hard Negatives and How UX Can Help
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-power-of-re-rankers-in-rag-systems" class="md-nav__link">
    <span class="md-ellipsis">
      The Power of Re-Rankers in RAG Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Power of Re-Rankers in RAG Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bi-encoders-vs-cross-encoders-understanding-the-trade-offs" class="md-nav__link">
    <span class="md-ellipsis">
      Bi-Encoders vs. Cross-Encoders: Understanding the Trade-offs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-training-data-for-re-rankers" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Training Data for Re-Rankers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-fine-tuning-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Fine-Tuning Workflow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Fine-Tuning Workflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#when-to-fine-tune-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      When to Fine-Tune Embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-fine-tuning-process" class="md-nav__link">
    <span class="md-ellipsis">
      The Fine-Tuning Process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Fine-Tuning Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-data-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Data Preparation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-model-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Model Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-training-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Training Infrastructure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measuring-success" class="md-nav__link">
    <span class="md-ellipsis">
      Measuring Success
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-pitfalls-to-avoid" class="md-nav__link">
    <span class="md-ellipsis">
      Common Pitfalls to Avoid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resources-for-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Resources for Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-different-approaches-systematically" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Different Approaches Systematically
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-a-roadmap-for-continuous-improvement" class="md-nav__link">
    <span class="md-ellipsis">
      Building a Roadmap for Continuous Improvement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-adapters-a-cost-effective-alternative" class="md-nav__link">
    <span class="md-ellipsis">
      Linear Adapters: A Cost-Effective Alternative
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reflection-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Reflection Questions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion-and-next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion and Next Steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="converting-evaluations-into-training-data-for-fine-tuning">Converting Evaluations into Training Data for Fine-Tuning</h1>
<div class="admonition abstract">
<p class="admonition-title">Chapter Overview</p>
</div>
<div class="highlight"><pre><span></span><code>This chapter explores how to transform evaluation data into valuable training assets:

- Converting evaluation examples into few-shot prompts
- Understanding the limitations of generic embeddings
- Creating datasets for fine-tuning retrieval models
- Learning how contrastive learning improves embeddings
- Testing approaches systematically
- Building a roadmap for continuous improvement
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Key Insight</p>
<p><strong>If you're not fine-tuning, you're Blockbuster, not Netflix.</strong> The goal isn't to fine-tune language models (which are expensive and complex), but to fine-tune embedding models that move toward your specific data distributions and improve retrieval, not generation.</p>
</div>
<div class="admonition success">
<p class="admonition-title">Fine-Tuning Cost Reality Check</p>
</div>
<p><strong>Embedding Model Fine-Tuning:</strong> - Cost: ~$1.50 for 6,000 examples - Time: 40 minutes on a laptop - Infrastructure: Consumer GPU or cloud notebook - Improvement: 6-10% better performance</p>
<div class="highlight"><pre><span></span><code>**Language Model Fine-Tuning:**
- Cost: $100-1000s depending on model size
- Time: Hours to days
- Infrastructure: Multiple GPUs or specialized services
- Complexity: Requires ML expertise

This dramatic difference explains why embedding fine-tuning should be your first focus.
</code></pre></div>
<h2 id="introduction">Introduction</h2>
<p>In the previous chapter, we established our evaluation framework and generated synthetic data to benchmark our RAG system. Now we take the crucial next step in our improvement journey: transforming these evaluations into practical training assets that can significantly boost performance.</p>
<p>!!! note "Prerequisites from Previous Chapters" - <strong><a href="../chapter0/">Chapter 0</a></strong>: Understanding the improvement flywheel concept - <strong><a href="../chapter1/">Chapter 1</a></strong>: Creating evaluation datasets with synthetic data</p>
<div class="highlight"><pre><span></span><code>The evaluation examples from Chapter 1 become your training data in this chapter.
</code></pre></div>
<p>This chapter bridges the gap between evaluation and production improvement, showing how the same datasets serve both purposes. The fundamental philosophy here is simple but powerful: <strong>the data you collect for evaluation should never go to waste</strong>. Every question, every relevance judgment, and every performance insight can—and should—be repurposed to train your system.</p>
<div class="admonition quote">
<p class="admonition-title">Key Philosophy</p>
</div>
<p>"Every evaluation example is a potential training example. The data flywheel transforms what begins as a handful of evaluation examples into few-shot prompts, then into training datasets for fine-tuning embedding models and re-rankers."</p>
<p>As we'll explore, this transformation process follows a natural progression. What begins as a handful of evaluation examples can evolve into few-shot prompts, then into training datasets for fine-tuning embedding models and re-rankers. This is the essence of the RAG improvement flywheel—data collected for one purpose fuels improvements across your entire system.</p>
<h2 id="why-generic-embeddings-fall-short">Why Generic Embeddings Fall Short</h2>
<p>Before we dive into the transformation process, we need to understand a fundamental challenge in RAG applications: generic embeddings from third-party providers often fall short for specialized applications. This isn't because they're poorly designed—in fact, models like OpenAI's embeddings are remarkably capable. The issue is that they're designed to serve every possible use case, which means they serve no specific use case perfectly.</p>
<div class="admonition warning">
<p class="admonition-title">Limitation of Generic Models</p>
</div>
<p>Generic embedding models inherit assumptions about what "similarity" means—assumptions that may not align with your specific needs. They don't know:</p>
<div class="highlight"><pre><span></span><code>1. The specific datasets they were trained on
2. The objective function that defined success during training
3. The weighting given to different types of similarity
4. The trade-offs made to accommodate diverse use cases
</code></pre></div>
<h3 id="the-elusive-nature-of-similarity">The Elusive Nature of "Similarity"</h3>
<p>At the heart of embedding models is a deceptively simple concept: they convert text (or other data) into numerical vectors that capture semantic meaning. The assumption is that items with similar meanings will have vectors that are close to each other when measured by cosine similarity or other distance metrics.</p>
<div class="admonition example">
<p class="admonition-title">Domain-Specific Similarity</p>
</div>
<div class="highlight"><pre><span></span><code>In e-commerce, what does it mean for two products to be similar? Are they similar because they&#39;re substitutes (different brands of red shirts) or complements (a shirt and matching pants)?

For music recommendations, are songs similar because they share the same genre, appear in the same playlists, or appeal to the same listeners? For a &quot;add more songs to this playlist&quot; feature, similarity might mean stylistic consistency, but for a discovery feature like Spotify&#39;s Discovery Weekly, it could mean something entirely different.

Perhaps the clearest example comes from dating apps. Should &quot;I love coffee&quot; and &quot;I hate coffee&quot; be considered similar or different? From a linguistic perspective, they&#39;re opposites. From a topic perspective, both profiles care enough about beverages to mention them prominently.

But there are many other interpretations: Maybe they&#39;re different because coffee lovers wouldn&#39;t date coffee haters. Maybe they&#39;re similar because both indicate people with strong food preferences (foodies). Maybe they&#39;re complementary because as long as one loves tea and one loves coffee, they&#39;ll actually get along well.

The key insight: **What matters for a dating app isn&#39;t textual similarity at all—it&#39;s whether two profiles predict if users will like each other.** This relationship isn&#39;t captured in generic embedding models trained on web text.
</code></pre></div>
<p>But here's the problem: "similarity" is poorly defined when we move beyond general language understanding. The correct answer isn't universal—it depends entirely on your application's objectives.</p>
<h3 id="the-hidden-assumptions-in-provider-models">The Hidden Assumptions in Provider Models</h3>
<p>When you use embedding models from providers like OpenAI, Cohere, or others, you're inheriting a set of assumptions about what "similarity" means—assumptions that may not align with your specific needs.</p>
<div class="admonition example">
<p class="admonition-title">Legal Document Search Failure</p>
</div>
<p>One memorable case involved a legal document search application. The generic embeddings performed reasonably well for finding factual information but struggled with procedural questions. The embeddings didn't adequately capture the relationships between legal procedures and their applications—a specific type of similarity vital to legal professionals but not emphasized in general-purpose training data.</p>
<p>The key insight here isn't that provider embeddings are bad—they're actually remarkable technical achievements. It's that their definition of similarity is generic, while your application needs are specific. And as we'll see, fine-tuning with your own data bridges this gap.</p>
<h2 id="from-evaluation-to-few-shot-examples">From Evaluation to Few-Shot Examples</h2>
<p>While fine-tuning embedding models can dramatically improve retrieval, we can often make significant improvements using a simpler approach: few-shot examples. Let's explore how to transform evaluation examples into effective few-shot prompts.</p>
<h3 id="the-power-of-examples-in-context">The Power of Examples in Context</h3>
<p>Few-shot learning has emerged as one of the most powerful techniques for guiding language model behavior. Rather than fine-tuning the model itself (which requires specialized infrastructure and significant data), few-shot learning simply includes examples within the prompt.</p>
<div class="admonition info">
<p class="admonition-title">How Few-Shot Learning Works</p>
</div>
<p>When you provide a language model with examples of how to respond to similar queries, you activate its ability to recognize patterns and apply them to new inputs. It's like showing a human a few examples of a task before asking them to perform it themselves—no specialized training required, just clear demonstrations.</p>
<p>This approach is particularly powerful for RAG applications because different query types often need different retrieval and response strategies. A few well-chosen examples can help the model recognize the current query type and apply the appropriate strategy.</p>
<h3 id="selecting-the-right-examples">Selecting the Right Examples</h3>
<p>Not all evaluation examples make good few-shot prompts. I've seen teams simply grab random examples from their evaluation set, only to find the model's performance actually decreased. The problem wasn't the model—it was the examples.</p>
<div class="admonition tip">
<p class="admonition-title">Characteristics of Good Examples</p>
</div>
<p>The best examples for few-shot learning share several characteristics:</p>
<div class="highlight"><pre><span></span><code>1. They represent common query patterns your users actually use
2. They demonstrate clear, step-by-step reasoning paths
3. They cover a diverse range of topics or question types
4. They avoid being too specific or unusual
</code></pre></div>
<p>Remember the synthetic data generation techniques we explored in Chapter 1? You can use those same methods to generate examples specifically for few-shot learning. The key difference is that for few-shot examples, you need not just questions and answers, but also the reasoning process that connects them.</p>
<h3 id="building-your-few-shot-library">Building Your Few-Shot Library</h3>
<p>Creating a comprehensive few-shot example library is a strategic investment that pays dividends across your entire RAG application. I recommend organizing your examples into a structured library:</p>
<ol>
<li>Start by filtering your evaluation data for the highest-quality examples</li>
<li>Group them by query type or intent (factual questions, how-to guides, comparisons, etc.)</li>
<li>Select representative examples from each group</li>
<li>Format them consistently for inclusion in prompts</li>
<li>Test their effectiveness with your RAG pipeline</li>
<li>Iterate and refine based on performance</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Structured Few-Shot Prompt</p>
</div>
<div class="highlight"><pre><span></span><code>You are an assistant specialized in answering questions about [domain].

    Here are some examples of how to answer questions:

    Question: [Example Question 1]
    Thinking: [First, I&#39;ll identify the key entities in the question. Then I&#39;ll look for information about their relationship...]
    Answer: [Example Answer 1]

    Question: [Example Question 2]
    Thinking: [This appears to be a comparison question. I should look for information about both entities and highlight similarities and differences...]
    Answer: [Example Answer 2]

    Now please answer the following question:
    Question: [Actual User Query]
    ```

This organized approach helps you maintain and evolve your example library as your application grows. You can track which examples work best for different situations, rotate examples to prevent overfitting, and continuously refine based on user interactions.

## Practical Implementation: Building the Data Flywheel for Fine-Tuning

While few-shot learning is powerful, fine-tuning your embedding models can create even more dramatic improvements in retrieval quality. The challenge is getting enough high-quality data to make fine-tuning worthwhile. This is where the concept of the data flywheel becomes crucial.

### Starting the Flywheel

I often tell teams that building a RAG application is like practicing martial arts—there&#39;s a &quot;wax on, wax off&quot; aspect to it. You start with a small set of examples that serve as your evaluation benchmarks. As you collect more data, those examples become few-shot prompts. And as your dataset grows further, it becomes training data for fine-tuning.

!!! info &quot;Data Collection Milestones&quot; - With 20 examples, you can build basic evaluation benchmarks - With 30 examples, you can create effective few-shot prompts - With 1000+ examples, you can fine-tune your retrieval models

The beauty of this approach is that you&#39;re continuously repurposing the same data for increasingly sophisticated improvements. Each stage builds on the previous one, creating a virtuous cycle of enhancement.

!!! warning &quot;Start Collecting Now&quot;
You need to start collecting the right data now, even if you&#39;re not ready to fine-tune yet. The sooner you start logging relevant user interactions, the sooner you&#39;ll reach the critical mass needed for fine-tuning.

### What Data Should You Log?

For RAG applications, the most valuable data points to collect include:

1. The actual queries users make
2. Which retrieved chunks were cited in the final responses
3. Which responses received positive feedback (and which didn&#39;t)
4. Which queries required refinement or follow-up

These signals help you understand which documents are truly relevant to which queries—the fundamental relationship you&#39;re trying to capture in fine-tuned embeddings.

!!! example &quot;Domain-Specific Relevance Signals&quot;
For other applications, the relevance signals will differ:

    - In e-commerce: track which items are purchased together, viewed in sequence, or added to the same lists
    - For music recommendations: log which songs appear in the same playlists or are hearted by the same users
    - For dating apps: record which profiles match and go on to have meaningful conversations

The key is defining what &quot;relevance&quot; means in your specific context and systematically collecting data that captures this relationship.

!!! warning &quot;Start Logging Yesterday!&quot;
I&#39;ve seen numerous companies hire machine learning engineers to fine-tune embedding models, only to realize they hadn&#39;t started logging relevance data. These teams then have to wait 3-6 months to collect enough data before they can begin the work they intended to do immediately.

**The most important action you can take today is to start logging relevance data**, even if you&#39;re not ready to hire ML specialists or begin fine-tuning. Save the top 20-40 chunks for each query and use an LLM to mark relevance if human annotation isn&#39;t feasible. This data will be invaluable when you&#39;re ready to improve your models.

I worked with one team that built a beautiful RAG application for internal documents but failed to implement any feedback collection mechanisms. Six months later, when they wanted to fine-tune their embeddings, they had to start from scratch with synthetic data because they had no record of which retrieved documents had actually been helpful to users. Don&#39;t make this mistake—plan your data collection from day one.

!!! success &quot;Small Datasets Can Make Big Differences&quot;
The team at Sentence Transformers has demonstrated that even with just 6,000 examples, you can achieve 6-10% better performance. With 40 minutes of fine-tuning on a laptop, you can create significant lifetime value for your application. This makes fine-tuning embedding models accessible even to teams without massive datasets or specialized infrastructure.

## Understanding Contrastive Learning for Embeddings

To understand how fine-tuning works for embedding models, we need to explore contrastive learning—the technique that powers most modern embedding fine-tuning approaches.

### Learning Through Contrasts

Contrastive learning is based on a simple but powerful idea: learning what things are similar by understanding what things are different. Rather than trying to predict absolute values, contrastive learning focuses on relative relationships.

!!! info &quot;Triplet Structure&quot;
The most common implementation uses a structure called a triplet, which consists of:

    1. An **anchor** (usually the query)
    2. A **positive example** (a document that&#39;s relevant to the query)
    3. A **negative example** (a document that&#39;s not relevant to the query)

The goal of training is straightforward: adjust the embedding model so that the distance between the anchor and positive example decreases, while the distance between the anchor and negative example increases. In other words, pull similar things closer together and push dissimilar things further apart.

```mermaid
graph LR
    A[Anchor: Query] --- P[Positive: Relevant Document]
    A --- N[Negative: Irrelevant Document]
    P -.- |&quot;Pull Closer&quot;| A
    N -.- |&quot;Push Away&quot;| A
</code></pre></div>
<p>This approach is particularly effective for embedding models because it directly optimizes for the distance relationships we care about in retrieval tasks.</p>
<h3 id="creating-effective-triplets-for-rag">Creating Effective Triplets for RAG</h3>
<p>For RAG applications, there are several natural ways to create triplet datasets:</p>
<ul>
<li><strong>Anchor</strong>: The user's query</li>
<li><strong>Positive</strong>: Document chunks that were cited in the final response or received positive feedback</li>
<li><strong>Negative</strong>: Document chunks that were retrieved but not cited, or received negative feedback</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Healthcare RAG Triplet</p>
</div>
<p>Imagine a healthcare RAG application where a user asks:</p>
<div class="highlight"><pre><span></span><code>```
What are the side effects of medication X?
```

Our retrieval system might return several documents, including:

```
Document A: &quot;Medication X may cause drowsiness, nausea, and in rare cases, allergic reactions.&quot;

Document B: &quot;Medication X is used to treat high blood pressure and should be taken with food.&quot;
```

If Document A is cited in the response while Document B isn&#39;t, we can create a triplet:

```json
{
  &quot;anchor&quot;: &quot;What are the side effects of medication X?&quot;,
  &quot;positive&quot;: &quot;Medication X may cause drowsiness, nausea, and in rare cases, allergic reactions.&quot;,
  &quot;negative&quot;: &quot;Medication X is used to treat high blood pressure and should be taken with food.&quot;
}
```
</code></pre></div>
<p>Through many such examples, the model learns that queries about side effects should be closer to texts describing adverse reactions than to texts describing indications or administration instructions.</p>
<h3 id="the-challenge-of-hard-negatives-and-how-ux-can-help">The Challenge of Hard Negatives and How UX Can Help</h3>
<p>The triplet example above introduces an important subtlety in contrastive learning. Notice that our negative example, "Medication X is used to treat high blood pressure," is still about the same medication—it's just not about side effects. This makes it what we call a "hard negative"—it's similar to what we're looking for in some ways (same medication) but different in crucial aspects (not about side effects).</p>
<div class="admonition example">
<p class="admonition-title">Hard Negative Mining Strategies</p>
</div>
<p><strong>Effective Approaches:</strong></p>
<div class="highlight"><pre><span></span><code>1. **Semantic Similarity with Different Intent:**
   - &quot;Software engineer&quot; vs &quot;Software engineering recruiter&quot;
   - Both about software roles, but serving different user needs

2. **User Deletion Signals:**
   - Track which documents users actively remove from results
   - These are perfect hard negatives - retrieved but explicitly rejected

3. **Category Boundaries:**
   - Items from adjacent but different categories
   - Example: &quot;Red running shoes&quot; vs &quot;Red dress shoes&quot;

4. **Temporal Relevance:**
   - Outdated versions of correct information
   - Example: &quot;2023 tax rates&quot; when user needs &quot;2024 tax rates&quot;
</code></pre></div>
<div class="admonition quote">
<p class="admonition-title">Agentic Retrieval Perspective</p>
</div>
<p>Colin Flaherty's work on agentic coding systems reveals a surprising insight: "We found that for SweeBench tasks, embedding-based retrieval was not the bottleneck - grep and find were sufficient." The agent's persistence effectively compensated for less sophisticated tools. This suggests that while fine-tuning embeddings is valuable, the agent layer can sometimes overcome retrieval limitations through persistence. <a href="../../talks/colin-rag-agents/">Learn more about agentic approaches →</a></p>
<div class="admonition info">
<p class="admonition-title">Value of Hard Negatives</p>
</div>
<p>Hard negatives are much more valuable for training than "easy negatives." If instead our negative example had been about car maintenance—completely unrelated to medications—the model wouldn't learn much from this contrast because it's already obvious that car maintenance isn't relevant to medication side effects.</p>
<div class="highlight"><pre><span></span><code>The truly challenging distinction—and the one that will improve our retrieval quality the most—is teaching the model to distinguish between different aspects of related topics.
</code></pre></div>
<p>This is where hard negative mining becomes crucial. Hard negative mining is the process of finding negative examples that are challenging but instructive for the model.</p>
<div class="admonition tip">
<p class="admonition-title">Designing UX for Better Training Data</p>
</div>
<p>If you're serious about improving your embeddings, consider explicitly designing your UX to capture these signals:</p>
<div class="highlight"><pre><span></span><code>1. **Document-level feedback mechanisms**: Add simple thumbs up/down options next to each retrieved document, not just for the final answer

2. **Click tracking**: Record which documents users click on and which they ignore—those ignored despite ranking highly are excellent hard negative candidates

3. **Dwell time analysis**: If a user quickly returns from a document without spending time reading it, that&#39;s a strong signal it wasn&#39;t relevant

4. **Explicit comparison interfaces**: For critical applications, consider interfaces that ask users to compare documents and select the most relevant one

5. **Query reformulation tracking**: When a user modifies their query slightly and gets better results, you can pair the original query with documents from the improved results to create training pairs
</code></pre></div>
<p>One particularly effective approach I've seen involved a "more like this" button next to helpful documents. This not only improved the immediate user experience but also created clear signals about which documents were semantically related in the users' mental models—relationships that might not be obvious from text content alone.</p>
<h2 id="the-power-of-re-rankers-in-rag-systems">The Power of Re-Rankers in RAG Systems</h2>
<p>While embedding models are the workhorses of retrieval, re-rankers provide an additional layer of refinement that can significantly improve results. Where embedding models (also called bi-encoders) encode queries and documents separately, re-rankers (cross-encoders) process them together to make more nuanced relevance judgments.</p>
<h3 id="bi-encoders-vs-cross-encoders-understanding-the-trade-offs">Bi-Encoders vs. Cross-Encoders: Understanding the Trade-offs</h3>
<p>The fundamental trade-off between embedding models and re-rankers is between speed and accuracy:</p>
<div class="admonition info">
<p class="admonition-title">Model Comparison</p>
</div>
<p><strong>Bi-encoders (embedding models)</strong>: - Encode query and document independently - Allow pre-computation of document embeddings - Enable fast vector similarity operations - Work well for first-pass retrieval of candidates - Examples include OpenAI's text-embedding models, SBERT, MPNet</p>
<div class="highlight"><pre><span></span><code>**Cross-encoders (re-rankers)**:
- Process query and document together as a pair
- Cannot pre-compute relevance scores
- Provide more accurate relevance judgments
- Work best for re-ranking a smaller set of candidates
- Examples include Cohere Rerank, monoT5
</code></pre></div>
<p>This complementary relationship makes them perfect partners in a two-stage retrieval process: use embeddings to quickly find candidate documents, then use a re-ranker to sort them more accurately.</p>
<div class="admonition example">
<p class="admonition-title">Re-Ranker Success Story</p>
</div>
<p>One team I worked with was debating whether to invest in fine-tuning their embeddings or implementing a re-ranker. When they tested both approaches, they found that fine-tuning embeddings improved recall from 65% to 78%, while adding a re-ranker (even without fine-tuning) improved it to 82%. Combining both approaches pushed performance to 91%—a transformative improvement from where they started.</p>
<h3 id="creating-training-data-for-re-rankers">Creating Training Data for Re-Rankers</h3>
<p>Re-rankers benefit from more nuanced training data than binary relevant/not-relevant labels. While you can start with the same data you use for embedding fine-tuning, consider enriching it with graded relevance scores:</p>
<ol>
<li>Create pairs of (query, document) with relevance scores on a scale (often 0-5)</li>
<li>Include a range of scores to help the model learn gradations of relevance</li>
<li>Train the model to predict these more nuanced relevance scores</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Graded Relevance Example</p>
</div>
<p><code>json     {       "query": "How do I reset my password?",       "documents": [         {"text": "Step-by-step password reset guide", "score": 5},         {"text": "General account management information", "score": 3},         {"text": "Creating a strong password", "score": 2},         {"text": "About our company", "score": 0}       ]     }</code></p>
<p>This richer data helps the re-ranker understand not just what's relevant versus irrelevant, but also what's highly relevant versus somewhat relevant—a distinction that can significantly improve user experience.</p>
<h2 id="practical-fine-tuning-workflow">Practical Fine-Tuning Workflow</h2>
<p>Based on extensive office hours discussions, here's a practical workflow for fine-tuning embedding models that consistently delivers results.</p>
<h3 id="when-to-fine-tune-embeddings">When to Fine-Tune Embeddings</h3>
<p>Fine-tune your embedding models when:</p>
<ol>
<li><strong>You have 6,000+ query-document pairs</strong> with relevance labels</li>
<li><strong>Domain-specific terminology</strong> isn't well-represented in generic models</li>
<li><strong>Your definition of similarity</strong> differs from general language understanding</li>
<li><strong>Cost at scale</strong> justifies maintaining your own infrastructure</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Production Insight</p>
</div>
<p>From office hours: "With just 6,000 examples from your domain, you can train embedding models and cross-encoders that outperform general-purpose models on your specific tasks. This typically costs around $1.50 and takes about 40 minutes on a laptop."</p>
<h3 id="the-fine-tuning-process">The Fine-Tuning Process</h3>
<h4 id="step-1-data-preparation">Step 1: Data Preparation</h4>
<p>Transform your evaluation data into training format:</p>
<ul>
<li><strong>Positive pairs</strong>: Query-document combinations that should rank highly</li>
<li><strong>Hard negatives</strong>: Similar but incorrect documents for each query</li>
<li><strong>Validation set</strong>: Hold out 20% for testing improvements</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Critical Success Factor</p>
</div>
<p>The quality of your hard negatives determines the quality of your fine-tuned model. Documents that are topically similar but serve different intents make the best hard negatives.</p>
<h4 id="step-2-model-selection">Step 2: Model Selection</h4>
<p>Choose your base model wisely:</p>
<ul>
<li><strong>For English-only</strong>: Modern BERT models with 8,000 token context (vs original 512)</li>
<li><strong>For multilingual</strong>: Cohere's multilingual models or mE5</li>
<li><strong>For specialized domains</strong>: Start with models pre-trained on similar content</li>
</ul>
<h4 id="step-3-training-infrastructure">Step 3: Training Infrastructure</h4>
<p>You don't need massive infrastructure:</p>
<ul>
<li><strong>Local training</strong>: Consumer GPU with 8GB+ VRAM</li>
<li><strong>Cloud notebooks</strong>: Colab Pro or similar services</li>
<li><strong>Training time</strong>: 30-60 minutes for most datasets</li>
<li><strong>Cost</strong>: Under $5 for most use cases</li>
</ul>
<h3 id="measuring-success">Measuring Success</h3>
<p>Track these metrics before and after fine-tuning:</p>
<ol>
<li><strong>Recall@K</strong> at different values (5, 10, 20)</li>
<li><strong>Mean Reciprocal Rank (MRR)</strong></li>
<li><strong>Business metrics</strong> tied to retrieval quality</li>
<li><strong>Latency impact</strong> if self-hosting</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Real-World Results</p>
</div>
<p>A healthcare company fine-tuned embeddings on medical abbreviations where generic models confused similar acronyms. Results: - Recall@10 improved from 72% to 89% - Reduced confusion between similar medical terms - Cost: $1.50 in compute, 45 minutes of training - ROI: Prevented multiple medical documentation errors</p>
<h3 id="common-pitfalls-to-avoid">Common Pitfalls to Avoid</h3>
<ol>
<li><strong>Training on too little data</strong>: Wait until you have at least 6,000 examples</li>
<li><strong>Ignoring hard negatives</strong>: Easy negatives don't improve the model</li>
<li><strong>Not validating on real queries</strong>: Synthetic data alone isn't sufficient</li>
<li><strong>Over-optimizing on metrics</strong>: Ensure improvements translate to user experience</li>
</ol>
<h3 id="resources-for-implementation">Resources for Implementation</h3>
<p>For detailed implementation guides:</p>
<ul>
<li><a href="https://www.sbert.net/docs/training/overview.html">Sentence Transformers Training Documentation</a></li>
<li><a href="https://docs.cohere.com/docs/fine-tuning">Cohere's Fine-tuning Guide</a></li>
<li><a href="https://platform.openai.com/docs/guides/fine-tuning">OpenAI's Fine-tuning Best Practices</a></li>
</ul>
<div class="admonition quote">
<p class="admonition-title">Key Takeaway</p>
</div>
<p>"It's probably a bad idea to train your own language model, but it's a very good idea to train your own embedding model. The infrastructure requirements are minimal, the process is well-understood, and the improvements are substantial for domain-specific applications."</p>
<h2 id="testing-different-approaches-systematically">Testing Different Approaches Systematically</h2>
<p>With your evaluation framework from Chapter 1 and your growing dataset of examples, you can now test various improvement approaches systematically. This experimental mindset is critical to making steady progress.</p>
<div class="admonition tip">
<p class="admonition-title">Good Experimentation Practices</p>
</div>
<p>Good experimentation requires discipline and structure. For each test:</p>
<div class="highlight"><pre><span></span><code>1. Form a clear hypothesis: &quot;Implementing a re-ranker will improve recall@10 by at least 15%&quot;
2. Define success criteria before running the experiment
3. Isolate a single variable whenever possible
4. Measure impact on your established metrics
5. Document both successful and unsuccessful experiments
</code></pre></div>
<p>Common experiments worth running include:</p>
<ol>
<li><strong>Embedding model comparisons</strong>: Test different models (OpenAI, Cohere, open-source alternatives)</li>
<li><strong>Chunking strategy variations</strong>: Try different chunk sizes and overlap percentages</li>
<li><strong>Retrieval method comparisons</strong>: Compare lexical, semantic, and hybrid approaches</li>
<li><strong>Re-ranking impact assessment</strong>: Measure the effect of adding a re-ranker</li>
<li><strong>Few-shot prompt variations</strong>: Test different examples and formats</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Debate Resolved Through Data</p>
</div>
<p>One team I worked with spent weeks debating which embedding model to use, with different team members advocating for their preferred option. Instead of continuing the debate, they implemented a simple experiment: they indexed their documents with three different embedding models and measured recall on their evaluation set. The results settled the debate in hours, not weeks, and the team moved forward with data-backed confidence.</p>
<p>This cyclical process creates a data-driven improvement flywheel that continuously enhances your system's performance.</p>
<h2 id="building-a-roadmap-for-continuous-improvement">Building a Roadmap for Continuous Improvement</h2>
<p>Based on your experimental results, you can now build a roadmap for ongoing improvements. This isn't just about technical enhancements—it's about creating a systematic process for evolution.</p>
<div class="admonition tip">
<p class="admonition-title">Prioritization Framework</p>
</div>
<p>When deciding what to improve next, consider multiple factors:</p>
<div class="highlight"><pre><span></span><code>1. **Impact**: Which changes will most dramatically improve key metrics?
2. **Effort**: How much work is required to implement each change?
3. **Dependencies**: Which improvements depend on others being completed first?
4. **Risk**: What is the chance of negative side effects or regressions?
</code></pre></div>
<p>I've found that impact/effort prioritization works particularly well for RAG improvements. Plot potential enhancements on a simple 2x2 grid with impact on one axis and effort on the other, then focus on high-impact, low-effort improvements first. These "quick wins" build momentum and demonstrate value while you prepare for more complex enhancements.</p>
<div class="admonition example">
<p class="admonition-title">Prioritization in Action</p>
</div>
<p>In one project, we identified that implementing BM25 hybrid retrieval would be high-impact and medium-effort, while fine-tuning custom embeddings would be high-impact but high-effort. We prioritized the hybrid retrieval first, which gave us immediate gains while we collected data for the eventual embedding fine-tuning.</p>
<h2 id="linear-adapters-a-cost-effective-alternative">Linear Adapters: A Cost-Effective Alternative</h2>
<p>Before diving into full fine-tuning, consider linear adapters - a technique that can deliver significant improvements at a fraction of the cost.</p>
<div class="admonition info">
<p class="admonition-title">What Are Linear Adapters?</p>
</div>
<p>Linear adapters add a small trainable layer on top of frozen embeddings: - Train only a linear transformation matrix - Keep the base embedding model unchanged - Combine benefits of domain specificity with pre-trained knowledge</p>
<div class="highlight"><pre><span></span><code>**Cost Comparison:**
- Full fine-tuning: $50-100 for meaningful datasets
- Linear adapters: ~$12 for the same improvement
- Training time: Minutes vs hours
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">When to Use Linear Adapters</p>
</div>
<p><strong>Perfect for:</strong> - Domain-specific terminology mapping - Multi-domain applications (train separate adapters) - Rapid experimentation - Limited computational resources</p>
<div class="highlight"><pre><span></span><code>**Implementation:**
```python
# Simplified example
base_embeddings = model.encode(texts)
adapted_embeddings = linear_adapter(base_embeddings)
```

You can train different adapters for different query types or domains, switching between them based on query classification.
</code></pre></div>
<h2 id="additional-resources">Additional Resources</h2>
<div class="admonition info">
<p class="admonition-title">Tools and Libraries</p>
</div>
<div class="highlight"><pre><span></span><code>### Understanding Embedding Models

1. **Sentence Transformers Library** ([https://www.sbert.net/](https://www.sbert.net/)): This library provides easy-to-use implementations for state-of-the-art embedding models, supporting both pairwise datasets and triplets for fine-tuning. It&#39;s my recommended starting point for most teams due to its balance of performance and ease of use.

2. **Modern BERT** ([https://huggingface.co/sentence-transformers](https://huggingface.co/sentence-transformers)): These newer models offer 8,000 token sequence lengths and generally outperform classic BERT-based models. The BGE models in particular have shown excellent performance across many domains and are worth testing in your applications.

3. **Cohere Re-ranking Models** ([https://cohere.com/rerank](https://cohere.com/rerank)): Cohere offers state-of-the-art re-ranking capabilities with a fine-tuning API that makes it relatively easy to customize for your specific needs. In my experience, even their base re-ranker without fine-tuning often provides substantial improvements to retrieval quality.

4. **Specialized Domains**: For specific domains like code, science, or legal documents, look for models pre-trained on related corpora. For example, CodeBERT for programming or SciBERT for scientific literature can provide better starting points than general models.

5. **Comparison to Data Labeling**: Everything we&#39;re doing today with fine-tuning embedding models is what I used to pay data labeling teams hundreds of thousands of dollars to do annually. The ML playbook that was once only accessible to large companies with significant budgets is now available to teams of all sizes thanks to advances in transfer learning and fine-tuning techniques.
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Key Concepts</p>
</div>
<div class="highlight"><pre><span></span><code>#### Contrastive Learning In-Depth

Contrastive learning trains models to recognize similarities and differences between items by pushing and pulling examples in the embedding space:

- **Triplet Loss**: Optimizes the distance between anchor-positive pairs relative to anchor-negative pairs
- **InfoNCE Loss**: Contrasts a positive pair against multiple negative examples
- **Multiple Negatives Ranking Loss**: Handles batches of queries with multiple negatives per query

#### Scaling and Efficiency Considerations

For large datasets or production workloads:

- Consider parallel processing frameworks (like Modal) to accelerate embedding and training
- Experiment with multi-GPU training for faster iterations
- Evaluate the trade-offs between API costs and self-hosting
- Test multiple model variations simultaneously to find optimal configurations
</code></pre></div>
<h2 id="reflection-questions">Reflection Questions</h2>
<p>!!! question "Self-Assessment" 1. What specific definition of "similarity" is most important for your application's domain?</p>
<div class="highlight"><pre><span></span><code>2. How would you create effective few-shot examples from your existing evaluation data?

3. What user interactions in your application could provide valuable training signals for fine-tuning?

4. If you had to prioritize one retrieval improvement for your system, would it be embeddings, re-ranking, or something else? Why?

5. What experiments could you run to test your hypotheses about improving retrieval quality?
</code></pre></div>
<h2 id="conclusion-and-next-steps">Conclusion and Next Steps</h2>
<p>In this chapter, we've explored how to transform evaluation data into valuable training assets:</p>
<ol>
<li>Converting evaluation examples into few-shot prompts</li>
<li>Understanding the limitations of generic embeddings</li>
<li>Creating datasets for fine-tuning retrieval models</li>
<li>Learning how contrastive learning improves embeddings</li>
<li>Testing approaches systematically</li>
<li>Building a roadmap for continuous improvement</li>
</ol>
<p>The key insight to take away is that data collection and repurposing form the foundation of systematic RAG improvement. Every question, every piece of feedback, and every evaluation can fuel your improvement flywheel if properly captured and utilized.</p>
<p>As we've seen, fine-tuning embedding models can dramatically improve the performance of your RAG application. Unlike fine-tuning large language models (which requires significant expertise and resources), embedding model fine-tuning is accessible to teams of all sizes, with demonstrated benefits from as few as 6,000 examples.</p>
<div class="admonition tip">
<p class="admonition-title">What's Coming Next</p>
</div>
<p>In <a href="../chapter3-1/">Chapter 3</a>, we'll dive into deployment strategies, user feedback collection methods, and how to use this feedback to further refine your RAG application. We'll explore practical techniques for gathering implicit and explicit feedback, designing effective user interfaces, and closing the loop between user interactions and system improvements.</p>
<p>!!! info "Related Concepts in Other Chapters" - <strong>Query Segmentation</strong> (<a href="../chapter4-2/">Chapter 4</a>): Learn how to identify which queries benefit most from fine-tuning - <strong>Specialized Models</strong> (<a href="../chapter5-1/">Chapter 5</a>): See how fine-tuned embeddings power specialized retrievers - <strong>Router Optimization</strong> (<a href="../chapter6-2/">Chapter 6</a>): Understand how fine-tuning improves query routing</p>
<h2 id="summary">Summary</h2>
<p>The data flywheel approach transforms what begins as evaluation into training assets that continuously improve your RAG system. By understanding the limitations of generic models, implementing few-shot examples, and preparing for fine-tuning, you create a foundation for ongoing enhancement.</p>
<p>The most critical actions to take immediately are:</p>
<ol>
<li><strong>Start logging relevancy data today</strong> - Even if you're not ready to fine-tune yet</li>
<li><strong>Define similarity for your domain</strong> - What makes two items "similar" in your specific context?</li>
<li><strong>Implement feedback mechanisms</strong> - Design your UX to collect the signals you'll need later</li>
<li><strong>Build your few-shot library</strong> - Begin transforming evaluation data into prompt examples</li>
<li><strong>Test domain-specific models</strong> - Explore fine-tuned models for your specific application area</li>
</ol>
<p>This systematic approach ensures that every piece of data you collect contributes to a cycle of improvement that makes your application increasingly effective for your specific use case. When done properly, this flywheel effect touches every part of your system—improving clustering, topic modeling, and all other aspects we'll explore in the coming weeks.</p>
<hr />
<p>IF you want to get discounts and 6 day email source on the topic make sure to subscribe to</p>
<script async data-uid="010fd9b52b" src="https://fivesixseven.kit.com/010fd9b52b/index.js"></script>







  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../chapter1/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Overview
              </div>
            </div>
          </a>
        
        
          
          <a href="../chapter3-1/" class="md-footer__link md-footer__link--next" aria-label="Next: Design Principles">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Design Principles
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://x.com/jxnlco" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "navigation.instant", "navigation.tracking", "navigation.expand", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.footer", "search.highlight", "search.share", "search.suggest", "toc.follow", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
    
  </body>
</html>